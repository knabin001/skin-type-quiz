<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Skin Type Quiz — Skin1004 Recommendations</title>
<style>
  :root{
    --bg:#f6fbf7;
    --card:#ffffff;
    --accent:#2f9e54;
    --accent-700:#238643;
    --muted:#6b7280;
    --success-bg:#e8f5e9;
    --warning-bg:#fff4e5;
    --radius:12px;
    --max-width:980px;
    --gap:12px;
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }

  html,body{height:100%}
  body{
    margin:0;
    background:var(--bg);
    color:#0f172a;
    padding:28px 20px;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    display:flex;
    justify-content:center;
  }

  .quiz-container{
    width:100%;
    max-width:var(--max-width);
    background:var(--card);
    border-radius:var(--radius);
    padding:22px;
    box-shadow:0 8px 30px rgba(2,6,23,0.08);
  }

  header{display:flex;align-items:flex-start;gap:14px}
  h1{margin:0;color:var(--accent);font-size:20px}
  p.lead{margin:6px 0 0;color:var(--muted);line-height:1.35}

  form{margin-top:18px}
  fieldset{border:0;margin:0;padding:0 0 14px}
  legend{font-weight:700;margin-bottom:8px}
  .options{display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:8px}
  label.option{
    display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;cursor:pointer;border:1px solid transparent;
    transition:all .12s ease;
  }
  label.option:hover{background:#f6fdf4}
  input[type="radio"]{width:18px;height:18px;flex:0 0 18px}
  label.option[aria-checked="true"]{background:#f3fbf4;border-color:var(--accent-700)}
  .actions{display:flex;gap:10px;margin-top:14px}
  button{
    background:var(--accent);
    color:white;
    border:0;
    padding:12px 16px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
  }
  button.secondary{
    background:#f1f5f9;color:#0f172a;border:1px solid #e6eef4;
  }
  button:disabled{opacity:.6;cursor:not-allowed}
  #result{margin-top:18px;padding:14px;border-radius:10px;display:none}
  .result-title{font-weight:700;margin:0 0 6px}
  .product{display:flex;gap:12px;align-items:flex-start;margin-top:8px}
  .product .info{flex:1}
  .product .title{margin:0;font-weight:800}
  .product .desc{margin:6px 0;color:var(--muted);line-height:1.3}
  .product a{color:var(--accent);text-decoration:none;font-weight:700}
  .note{font-size:13px;color:var(--muted);margin-top:10px}

  /* Shop grid */
  #shop{margin-top:22px}
  .shop-header{display:flex;justify-content:space-between;align-items:center;gap:10px}
  .shop-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;margin-top:12px}
  .card{border-radius:10px;border:1px solid #e9f5ee;padding:12px;background:white;display:flex;flex-direction:column;gap:8px}
  .card h3{margin:0;font-size:15px}
  .card p{margin:0;color:var(--muted);font-size:13px}
  .card .meta{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:8px}
  .like-btn{background:transparent;border:0;color:#ef4444;font-size:18px;cursor:pointer}
  .like-btn.liked{color:#dc2626}
  .shop-link{font-size:13px;color:var(--accent);text-decoration:none}

  @media (max-width:520px){
    .options{grid-template-columns:1fr}
  }
  .sr-only{position:absolute!important;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}
</style>
</head>
<body>
  <main class="quiz-container" role="main" aria-labelledby="quizTitle">
    <header>
      <div>
        <h1 id="quizTitle">Find Your Skin Type</h1>
        <p class="lead">5 quick questions — get a tailored Skin1004 product recommendation and short usage tips.</p>
      </div>
    </header>

    <form id="quizForm" aria-describedby="formHelp" novalidate>
      <p id="formHelp" class="sr-only">Choose one option per question. Select all five answers to see your recommendation.</p>

      <fieldset data-q="q1">
        <legend>1. How does your skin feel after cleansing?</legend>
        <div class="options" role="radiogroup" aria-labelledby="">
          <label class="option" data-value="dry"><input type="radio" name="q1" value="dry" required> Tight and dry</label>
          <label class="option" data-value="oily"><input type="radio" name="q1" value="oily"> Shiny and greasy</label>
          <label class="option" data-value="normal"><input type="radio" name="q1" value="normal"> Comfortable</label>
          <label class="option" data-value="combo"><input type="radio" name="q1" value="combo"> Oily in T-zone, dry elsewhere</label>
        </div>
      </fieldset>

      <fieldset data-q="q2">
        <legend>2. How often do you get breakouts?</legend>
        <div class="options" role="radiogroup">
          <label class="option" data-value="oily"><input type="radio" name="q2" value="oily" required> Often</label>
          <label class="option" data-value="normal"><input type="radio" name="q2" value="normal"> Rarely</label>
          <label class="option" data-value="dry"><input type="radio" name="q2" value="dry"> Almost never</label>
          <label class="option" data-value="combo"><input type="radio" name="q2" value="combo"> Only in certain areas</label>
        </div>
      </fieldset>

      <fieldset data-q="q3">
        <legend>3. How does your skin look midday?</legend>
        <div class="options" role="radiogroup">
          <label class="option" data-value="dry"><input type="radio" name="q3" value="dry" required> Dull and flaky</label>
          <label class="option" data-value="oily"><input type="radio" name="q3" value="oily"> Very shiny</label>
          <label class="option" data-value="normal"><input type="radio" name="q3" value="normal"> Fresh and balanced</label>
          <label class="option" data-value="combo"><input type="radio" name="q3" value="combo"> Shiny forehead/nose, dry cheeks</label>
        </div>
      </fieldset>

      <fieldset data-q="q4">
        <legend>4. How sensitive is your skin?</legend>
        <div class="options" role="radiogroup">
          <label class="option" data-value="dry"><input type="radio" name="q4" value="dry" required> Very sensitive</label>
          <label class="option" data-value="oily"><input type="radio" name="q4" value="oily"> Not sensitive</label>
          <label class="option" data-value="normal"><input type="radio" name="q4" value="normal"> Occasionally sensitive</label>
          <label class="option" data-value="combo"><input type="radio" name="q4" value="combo"> Sensitive in some areas</label>
        </div>
      </fieldset>

      <fieldset data-q="q5">
        <legend>5. How visible are your pores?</legend>
        <div class="options" role="radiogroup">
          <label class="option" data-value="dry"><input type="radio" name="q5" value="dry" required> Small and tight</label>
          <label class="option" data-value="oily"><input type="radio" name="q5" value="oily"> Large and visible</label>
          <label class="option" data-value="normal"><input type="radio" name="q5" value="normal"> Medium</label>
          <label class="option" data-value="combo"><input type="radio" name="q5" value="combo"> Large in T-zone only</label>
        </div>
      </fieldset>

      <div class="actions" role="group" aria-label="Quiz actions">
        <button type="button" id="submitBtn">Get My Skin Type</button>
        <button type="button" class="secondary" id="resetBtn">Reset</button>
      </div>
    </form>

    <div id="result" role="status" aria-live="polite"></div>
    <p class="note">Recommendations are suggestions only. Patch-test products and consult a dermatologist for specific medical concerns.</p>

    <!-- Shop products from Serenhive -->
    <section id="shop" aria-labelledby="shopTitle">
      <div class="shop-header">
        <h2 id="shopTitle" style="margin:0;font-size:16px;color:var(--accent)">Shop Skin1004 products</h2>
        <a class="shop-link" href="https://www.serenhive.com.np/shop/category/skin1004-9" target="_blank" rel="noopener">Browse all on Serenhive</a>
      </div>

      <div class="shop-grid" id="shopGrid" aria-live="polite">
        <!-- Product cards rendered by JS -->
      </div>
    </section>

  </main>

<script>
(function(){
  const form = document.getElementById('quizForm');
  const submitBtn = document.getElementById('submitBtn');
  const resetBtn = document.getElementById('resetBtn');
  const resultEl = document.getElementById('result');
  const shopGrid = document.getElementById('shopGrid');

  // Products — names chosen to match common Skin1004 SKUs from Serenhive category.
  // If you want exact product page links, provide them or I can scrape and add per-region links.
  const SERENHIVE_CATEGORY = 'https://www.serenhive.com.np/shop/category/skin1004-9';
  const products = [
    { id: 'madagascar-centella-ampoule', name: 'Madagascar Centella Ampoule', short: 'Calming centella serum to soothe and strengthen skin barrier.' },
    { id: 'hyalu-cica-water-gel-cream', name: 'Hyalu-Cica Water-Gel Cream', short: 'Hydrating gel-cream with hyaluronic acid + cica for sensitive, dry skin.' },
    { id: 'niacinamide-8-ampoule', name: 'Niacinamide 8% Ampoule', short: 'Brightening ampoule to help with tone and texture.' },
    { id: 'purecica-serum', name: 'Purecica SOS Serum', short: 'Soothing serum for redness-prone skin.' },
    { id: 'centella-cream', name: 'Centella Repair Cream', short: 'Rich cream to support compromised skin barrier.' },
    { id: 'suncreen-spf50', name: 'Daily Sun Block SPF50+', short: 'Lightweight sunscreen to protect and hydrate.' }
  ];

  // Likes persisted in localStorage under key 'skin1004_likes_v1'
  const STORAGE_KEY = 'skin1004_likes_v1';
  const likes = loadLikes();

  function loadLikes(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : {};
    }catch(e){ return {}; }
  }
  function saveLikes(){
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(likes)); }catch(e){}
  }

  function renderShop(){
    shopGrid.innerHTML = '';
    products.forEach(p => {
      const card = document.createElement('article');
      card.className = 'card';
      card.setAttribute('data-id', p.id);

      const title = document.createElement('h3');
      title.textContent = p.name;

      const desc = document.createElement('p');
      desc.textContent = p.short;

      const meta = document.createElement('div');
      meta.className = 'meta';

      const link = document.createElement('a');
      link.href = SERENHIVE_CATEGORY;
      link.target = '_blank';
      link.rel = 'noopener';
      link.className = 'shop-link';
      link.textContent = 'View on Serenhive';

      const likeBtn = document.createElement('button');
      likeBtn.className = 'like-btn';
      likeBtn.title = 'Like product';
      likeBtn.innerHTML = likes[p.id] && likes[p.id].liked ? '♥' : '♡';
      if(likes[p.id] && likes[p.id].liked) likeBtn.classList.add('liked');

      likeBtn.addEventListener('click', () => {
        const current = likes[p.id] && likes[p.id].liked;
        likes[p.id] = { liked: !current, ts: Date.now() };
        saveLikes();
        likeBtn.innerHTML = likes[p.id].liked ? '♥' : '♡';
        likeBtn.classList.toggle('liked', likes[p.id].liked);
        // small a11y live update
        likeBtn.setAttribute('aria-pressed', String(likes[p.id].liked));
      });

      meta.appendChild(link);
      meta.appendChild(likeBtn);

      card.appendChild(title);
      card.appendChild(desc);
      card.appendChild(meta);

      shopGrid.appendChild(card);
    });
  }

  // existing quiz logic (kept mostly the same)
  const productMap = {
    dry: {
      name: 'Hyalu-Cica Water-Gel Cream',
      desc: 'Lightweight but highly hydrating; helps soothe and lock in moisture without heaviness — ideal for dry or sensitive skin layers.',
      why: 'Use after serum (AM/PM) to seal hydration. Apply to damp skin for best absorption.'
    },
    oily: {
      name: 'Madagascar Centella Ampoule',
      desc: 'A calming, lightweight ampoule rich in centella asiatica extract to soothe inflammation while keeping texture light for oily skin.',
      why: 'Use 2–3 drops on damp skin before moisturizer. Helps soothe and balance oil-prone areas.'
    },
    normal: {
      name: 'Madagascar Centella Ampoule',
      desc: 'A gentle everyday serum to support the skin barrier and maintain balance for normal skin.',
      why: 'Use mornings and evenings under moisturizer to keep skin comfortable and resilient.'
    },
    combo: {
      name: 'Madagascar Centella Ampoule + Light Moisturizer',
      desc: 'Use the ampoule to calm red or dry patches; pair with a lightweight gel-cream on oily zones to keep balance.',
      why: 'Apply ampoule evenly, then a gel moisturizer on the T-zone if needed. Spot-treat dry cheeks with richer cream.'
    }
  };

  document.querySelectorAll('label.option').forEach(label => {
    const input = label.querySelector('input[type="radio"]');
    input.addEventListener('change', () => {
      const group = input.name;
      document.querySelectorAll(`label.option input[name="${group}"]`).forEach(i => {
        i.closest('label').setAttribute('aria-checked', i.checked ? 'true' : 'false');
      });
    });
    label.addEventListener('keydown', (e) => {
      if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); input.checked = true; input.dispatchEvent(new Event('change')); }
    });
  });

  function validateAnswers(formData){
    return ['q1','q2','q3','q4','q5'].every(name => formData.get(name));
  }

  function calculateResult(){
    const data = new FormData(form);
    if(!validateAnswers(data)){
      resultEl.style.display = 'block';
      resultEl.style.background = 'var(--warning-bg)';
      resultEl.innerHTML = '<strong>Please answer all 5 questions</strong><div class="desc">We need every answer to provide an accurate recommendation.</div>';
      resultEl.scrollIntoView({behavior:'smooth',block:'center'});
      return;
    }

    const score = { dry:0, oily:0, normal:0, combo:0 };
    for(const name of ['q1','q2','q3','q4','q5']){
      const v = data.get(name);
      if(score.hasOwnProperty(v)) score[v]++;
    }

    const priority = ['normal','combo','oily','dry'];
    let winner = null;
    let max = -1;
    for(const key of Object.keys(score)){
      if(score[key] > max){ max = score[key]; winner = key; }
      else if(score[key] === max){
        const curIdx = priority.indexOf(winner);
        const newIdx = priority.indexOf(key);
        if(newIdx < curIdx) winner = key;
      }
    }

    const product = productMap[winner] || productMap.normal;

    resultEl.style.display = 'block';
    resultEl.style.background = 'var(--success-bg)';
    resultEl.innerHTML = ''
      + `<div class="result-title">Your skin type: ${winner.toUpperCase()}</div>`
      + `<div class="product" aria-hidden="false">`
      + `  <div class="info">`
      + `    <p class="title">${escapeHtml(product.name)}</p>`
      + `    <p class="desc">${escapeHtml(product.desc)}</p>`
      + `    <p style="margin:0 0 8px"><strong>Usage:</strong> ${escapeHtml(product.why)}</p>`
      + `    <p style="margin:0"><a href="${SERENHIVE_CATEGORY}" target="_blank" rel="noopener">Buy on Serenhive</a></p>`
      + `  </div>`
      + `</div>`;

    resultEl.scrollIntoView({behavior:'smooth',block:'center'});
  }

  function escapeHtml(str){
    return String(str)
      .replace(/&/g,'&amp;')
      .replace(/</g,'&lt;')
      .replace(/>/g,'&gt;')
      .replace(/"/g,'&quot;')
      .replace(/'/g,'&#39;');
  }

  submitBtn.addEventListener('click', calculateResult);
  resetBtn.addEventListener('click', () => {
    form.reset();
    document.querySelectorAll('label.option').forEach(l => l.setAttribute('aria-checked','false'));
    resultEl.style.display = 'none';
    resultEl.innerHTML = '';
  });

  form.addEventListener('keydown', (e) => {
    if(e.key === 'Enter' && (e.target.type === 'radio' || e.target.tagName === 'LABEL')){
      e.preventDefault();
      calculateResult();
    }
  });

  // render shop on load
  renderShop();
})();
</script>
</body>
</html>
